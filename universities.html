<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Список университетов</title>
</head>
<body>
    <h1>Список университетов</h1>
    
    <label for="city-filter">Выберите город:</label>
    <select id="city-filter">
        <option value="">Все города</option>
        <!-- Динамически загружаемые города -->
    </select>

    <label for="profession-filter">Выберите профессию:</label>
    <select id="profession-filter">
        <option value="">Все профессии</option>
        <!-- Динамически загружаемые профессии -->
    </select>

    <div id="universities-list">
        <!-- Университеты будут отображаться здесь -->
    </div>

    <script>
        async function loadUniversitiesData() {
            try {
                const response = await fetch('https://raw.githubusercontent.com/MikaAsk/Keleshek_site.kz/main/processed_university_data7.json');
                const universities = await response.json();

                populateFilters(universities);
                displayUniversities(universities);
            } catch (error) {
                console.error('Ошибка при загрузке данных:', error);
            }
        }

        function populateFilters(universities) {
            const citySelect = document.getElementById('city-filter');
            const professionSelect = document.getElementById('profession-filter');

            const cities = [...new Set(universities.map(u => u['Город']))];
            const professions = [...new Set(universities.flatMap(u => (u['Образовательные программы'] || "").split(';').map(p => p.trim())))];

            cities.forEach(city => {
                const option = document.createElement('option');
                option.value = city;
                option.textContent = city;
                citySelect.appendChild(option);
            });

            professions.forEach(profession => {
                const option = document.createElement('option');
                option.value = profession;
                option.textContent = profession;
                professionSelect.appendChild(option);
            });
        }

        function displayUniversities(universities) {
            const cityFilter = document.getElementById('city-filter').value;
            const professionFilter = document.getElementById('profession-filter').value;

            const filteredUniversities = universities.filter(university => {
                const cityMatches = cityFilter === "" || university['Город'] === cityFilter;
                const professionMatches = professionFilter === "" || university['Образовательные программы'] && university['Образовательные программы'].split(';').some(p => p.trim() === professionFilter);
                return cityMatches && professionMatches;
            });

            const universitiesList = document.getElementById('universities-list');
            universitiesList.innerHTML = '';

            filteredUniversities.forEach(university => {
                const universityCard = document.createElement('div');
                universityCard.classList.add('university-card');
                
                const universityName = university['Название университета'];
                const universityCity = university['Город'];
                const universityDescription = university['Описание'];
                const universitySite = university['Сайт'];
                const universityPrograms = university['Образовательные программы'];

                universityCard.innerHTML = `
                    <h3><a href="${universitySite}" target="_blank">${universityName}</a></h3>
                    <p><strong>Город:</strong> ${universityCity}</p>
                    <p><strong>Описание:</strong> ${universityDescription}</p>
                    <p><strong>Образовательные программы:</strong> ${universityPrograms.split(';').join(', ')}</p>
                `;

                universitiesList.appendChild(universityCard);
            });
        }

        document.getElementById('city-filter').addEventListener('change', () => {
            loadUniversitiesData();
        });
        document.getElementById('profession-filter').addEventListener('change', () => {
            loadUniversitiesData();
        });

        window.onload = loadUniversitiesData;
    </script>
</body>
</html>
